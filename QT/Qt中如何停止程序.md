# 问  
怎样停止所有程序呢？我运行BankServer,发现DBeaver显示成功建表了，如果我重复运行会导致问题吗？  

# 答  
作为架构师，我来解答关于“停止程序”和“重复运行”的工程疑问。

---

### 一、 怎样停止程序？

在 Qt Creator 中，停止正在运行的程序（无论客户端还是服务端）有三种主要方法：

1.  **红色的停止按钮（最常用）：**
    在 Qt Creator 左下角的“运行”按钮上方，或者在底部的 **“应用程序输出 (Application Output)”** 窗口左侧，有一个**红色的正方形按钮**。点击它就会强制关闭当前选中的运行目标。

2.  **关闭控制台/窗口：**
    *   如果服务端弹出了黑色的控制台窗口，直接点击窗口右上角的 `X` 掉它。
    *   如果客户端界面出来了，直接关闭窗口。

3.  **使用任务管理器（终极手段）：**
    如果程序卡死（僵尸进程），打开 Windows 任务管理器（`Ctrl + Shift + Esc`），在“详细信息”里找到 `BankServer.exe` 或 `BankClient.exe`，右键点击“结束任务”。

---

### 二、 重复运行会导致问题吗？

**简单结论：不会导致数据库损坏，但会导致程序启动失败。**

让我们从底层逻辑分析：

#### 1. 数据库层面：它是“幂等”的（Safe）
你在 DBeaver 里看到的表是由 `database.cpp` 里的 SQL 语句创建的。原作者在写 SQL 时使用了：
`CREATE TABLE IF NOT EXISTS ...`
*   **逻辑：** 每次服务端启动都会运行这行代码。如果表已经存在，MySQL 会直接返回“跳过”，不会报错，也不会覆盖你已有的数据。
*   **管理员账号：** 代码里也写了逻辑，会先 `SELECT COUNT(*)` 检查 `admin` 是否存在，只有不存在时才插入。
*   **结论：** **随便重启，数据是安全的。**

#### 2. 网络层面：端口独占（Conflict）
这是你最需要注意的地方。**在同一台电脑上，一个端口只能被一个程序占用。**
*   如果你已经运行了一个 `BankServer` 且没有关闭，当你尝试运行第二个 `BankServer` 时：
    *   第二个服务端会启动失败，报错：`Failed to start server: The address is already in use`。
*   **操作习惯：** 每次修改代码后，先点“停止”，再点“运行”。

---

### 三、 现在的关键：解决 9000 端口连不上的问题

既然 DBeaver 证实表已经建好了，说明你的服务端**曾经成功运行过**。为什么刚才客户端连不上 `9000` 呢？

**请按以下顺序执行“工程复位”操作：**

1.  **彻底清理环境：**
    *   在 Qt Creator 里点击停止按钮，确保没有任何 `BankServer` 或 `BankClient` 在运行。
    *   （保险起见）去任务管理器看看有没有残留的 `BankServer.exe`。

2.  **启动服务端 (`BankServer`)：**
    *   点击运行。
    *   **关键：** 盯着 "Application Output" 窗口。
    *   如果你看到 `Server started successfully, listening on port 9000` 且**程序没有自动退出**，说明它现在正稳稳地守在 9000 端口。

3.  **启动客户端 (`BankClient`)：**
    *   在 Qt Creator 里切换到 `BankClient` 目标，点击运行。
    *   地址：`localhost`，端口：`9000`。
    *   点击连接。

**如果还是 `Connection refused`，请检查以下“玄学”因素：**
*   **Windows 防火墙：** 可能会弹出提醒，请务必勾选“允许在私有网络和公用网络通信”。
*   **代理软件：** 如果你开了系统代理（VPN），有时它会拦截 `localhost`。尝试关闭代理软件后再连。

**下一步：** 只要你能看到客户端显示“状态：已连接”，你就成功打通了整个银行系统的任督二脉！快去试试吧。