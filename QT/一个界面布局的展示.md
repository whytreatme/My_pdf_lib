## 界面展示  
![银行ui界面](https://imgur.com/a/g6WnvIF)  

## 代码实现  
```cpp
setWindowTitle("银行系统 - 登录");
    setMinimumSize(550, 450);

    // 创建服务器设置控件
    m_serverIpEdit = new QLineEdit(this);
    m_serverIpEdit->setPlaceholderText("例如: 127.0.0.1 或 localhost");
    m_serverIpEdit->setText("localhost");
    m_serverIpEdit->setMaxLength(50);
    m_serverIpEdit->setMinimumHeight(35);

    m_serverPortEdit = new QLineEdit(this);
    m_serverPortEdit->setPlaceholderText("例如: 9000");
    m_serverPortEdit->setText("9000");
    m_serverPortEdit->setValidator(new QIntValidator(1, 65535, this));
    m_serverPortEdit->setMinimumHeight(35);

    m_connectBtn = new QPushButton("连接", this);
    m_connectBtn->setMinimumHeight(35);

    m_connectionStatusLabel = new QLabel("状态: 未连接", this);
    m_connectionStatusLabel->setStyleSheet("QLabel { color: red; }");

    // 创建用户名密码控件
    m_modeLabel = new QLabel("当前模式: 用户登录（16位卡号）", this);
    m_modeLabel->setStyleSheet("QLabel { color: blue; font-weight: bold; }");
    
    m_usernameEdit = new QLineEdit(this);
    m_usernameEdit->setPlaceholderText("请输入16位银行卡号");
    m_usernameEdit->setMaxLength(16);
    m_usernameEdit->setMinimumHeight(45);
    m_usernameEdit->setMinimumWidth(300);
    m_usernameEdit->setStyleSheet("QLineEdit { font-size: 16px; }");
    // 用户模式只允许16位数字
    m_usernameEdit->setValidator(new QRegularExpressionValidator(QRegularExpression("^[0-9]{16}$"), this));

    m_passwordEdit = new QLineEdit(this);
    m_passwordEdit->setPlaceholderText("请输入6位数字密码");
    m_passwordEdit->setEchoMode(QLineEdit::Password);
    m_passwordEdit->setMaxLength(50);
    m_passwordEdit->setMinimumHeight(45);
    m_passwordEdit->setMinimumWidth(300);
    m_passwordEdit->setStyleSheet("QLineEdit { font-size: 16px; }");

    m_loginBtn = new QPushButton("登录", this);
    m_loginBtn->setMinimumHeight(40);
    m_loginBtn->setEnabled(false);  // 初始禁用，连接后启用

    m_switchModeBtn = new QPushButton("切换为管理员登录", this);
    m_switchModeBtn->setMinimumHeight(40);
    m_switchModeBtn->setStyleSheet("QPushButton { background-color: #1976D2; color: white; }");

    m_messageLabel = new QLabel("", this);
    m_messageLabel->setWordWrap(true);
    m_messageLabel->setAlignment(Qt::AlignCenter);

    // 创建布局
    QFormLayout* serverLayout = new QFormLayout();
    serverLayout->setFormAlignment(Qt::AlignCenter);
    serverLayout->setLabelAlignment(Qt::AlignRight);
    serverLayout->addRow("服务器地址:", m_serverIpEdit);
    serverLayout->addRow("端口:", m_serverPortEdit);

    QHBoxLayout* connectLayout = new QHBoxLayout();
    connectLayout->addWidget(m_connectBtn);
    connectLayout->addWidget(m_connectionStatusLabel);

    QFormLayout* formLayout = new QFormLayout();
    formLayout->setFormAlignment(Qt::AlignCenter);
    formLayout->setLabelAlignment(Qt::AlignRight);
    formLayout->setSpacing(15);
    formLayout->addRow(m_modeLabel);
    formLayout->addRow("用户名:", m_usernameEdit);
    formLayout->addRow("密码:", m_passwordEdit);

    QHBoxLayout* buttonLayout = new QHBoxLayout();
    buttonLayout->addWidget(m_loginBtn);
    buttonLayout->addWidget(m_switchModeBtn);

    QVBoxLayout* mainLayout = new QVBoxLayout(this);
    mainLayout->addStretch();
    mainLayout->addLayout(serverLayout);
    mainLayout->addLayout(connectLayout);
    mainLayout->addSpacing(20);
    mainLayout->addLayout(formLayout);
    mainLayout->addSpacing(20);
    mainLayout->addLayout(buttonLayout);
    mainLayout->addSpacing(20);
    mainLayout->addWidget(m_messageLabel);
    mainLayout->addStretch();

    // 设置边距
    mainLayout->setContentsMargins(40, 40, 40, 40);

    // 连接按钮信号
    connect(m_connectBtn, &QPushButton::clicked,
            this, &LoginWidget::onConnectClicked);
    connect(m_loginBtn, &QPushButton::clicked,
            this, &LoginWidget::onLoginClicked);
    connect(m_switchModeBtn, &QPushButton::clicked,
            this, &LoginWidget::onSwitchModeClicked);

    // 允许回车键登录
    m_passwordEdit->setEnabled(true);
    connect(m_passwordEdit, &QLineEdit::returnPressed,
            this, &LoginWidget::onLoginClicked);
```  

## 代码分析  
好的，我们来把这段代码想象成搭积木，一步步看它是如何构建出整个界面的。

你的理解是正确的，`QHBoxLayout` 是水平摆放，`QVBoxLayout` 是垂直摆放。这段代码的精髓在于**将不同的小布局（积木块）组合成一个大布局**。

我们来逐一拆解：

### 第一块积木：服务器设置 (`serverLayout`)

````cpp
QFormLayout* serverLayout = new QFormLayout();
serverLayout->addRow("服务器地址:", m_serverIpEdit);
serverLayout->addRow("端口:", m_serverPortEdit);
````

*   **类型**：`QFormLayout` (表单布局)
*   **作用**：专门用来做“标签: 输入框”这种成对的样式，它会自动对齐标签和输入框。
*   **效果图**：
    ```
    服务器地址: [  IP输入框  ]
           端口: [ 端口输入框 ]
    ```

### 第二块积木：连接操作 (`connectLayout`)

````cpp
QHBoxLayout* connectLayout = new QHBoxLayout();
connectLayout->addWidget(m_connectBtn);
connectLayout->addWidget(m_connectionStatusLabel);
````

*   **类型**：`QHBoxLayout` (水平布局)
*   **作用**：把控件从左到右依次排开。
*   **效果图**：
    ```
    [ 连接按钮 ] [ 状态: 未连接 ]
    ```

### 第三块积木：用户登录表单 (`formLayout`)

````cpp
QFormLayout* formLayout = new QFormLayout();
formLayout->addRow(m_modeLabel);
formLayout->addRow("用户名:", m_usernameEdit);
formLayout->addRow("密码:", m_passwordEdit);
````

*   **类型**：`QFormLayout` (表单布局)
*   **作用**：同样是用于表单，但这里第一行只放了一个标签。
*   **效果图**：
    ```
    [ 当前模式: 用户登录... ]
      用户名: [ 用户名输入框 ]
         密码: [  密码输入框  ]
    ```

### 第四块积木：底部按钮 (`buttonLayout`)

````cpp
QHBoxLayout* buttonLayout = new QHBoxLayout();
buttonLayout->addWidget(m_loginBtn);
buttonLayout->addWidget(m_switchModeBtn);
````

*   **类型**：`QHBoxLayout` (水平布局)
*   **作用**：把两个按钮并排放在一起。
*   **效果图**：
    ```
    [ 登录按钮 ] [ 切换模式按钮 ]
    ```

### 最终组合：主布局 (`mainLayout`)

现在，我们有了一个“垂直大架子” `QVBoxLayout`，然后把上面所有的小积木块按顺序放进去。

````cpp
QVBoxLayout* mainLayout = new QVBoxLayout(this);
mainLayout->addStretch();                // 1. 在顶部增加一个弹簧
mainLayout->addLayout(serverLayout);     // 2. 放入服务器设置
mainLayout->addLayout(connectLayout);    // 3. 放入连接操作
mainLayout->addSpacing(20);              // 4. 增加 20 像素的固定间距
mainLayout->addLayout(formLayout);       // 5. 放入用户登录表单
mainLayout->addSpacing(20);              // 6. 增加 20 像素的固定间距
mainLayout->addLayout(buttonLayout);     // 7. 放入底部按钮
mainLayout->addSpacing(20);              // 8. 增加 20 像素的固定间距
mainLayout->addWidget(m_messageLabel);   // 9. 放入消息提示标签
mainLayout->addStretch();                // 10. 在底部增加一个弹簧
````

*   **`addStretch()`** 的作用非常关键：它是一个**弹簧**。它会尽可能地伸展，抢占所有剩余的空白空间。这里在顶部和底部各放一个，效果就是把中间的所有内容**推到窗口的垂直中心**。
*   **`addSpacing()`** 的作用是增加固定大小的空白，让布局看起来不那么拥挤。

### 最终效果图

把所有部分组合起来，`mainLayout` 就构建出了这样的结构：

```
+-----------------------------------------+
|           (空白, 被弹簧撑开)            |
|                                         |
|      服务器地址: [  IP输入框  ]          |
|             端口: [ 端口输入框 ]          |
|                                         |
|      [ 连接按钮 ] [ 状态: 未连接 ]      |
|                                         |
|      <---- 20像素间距 ---->             |
|                                         |
|      [ 当前模式: 用户登录... ]          |
|        用户名: [ 用户名输入框 ]         |
|           密码: [  密码输入框  ]         |
|                                         |
|      <---- 20像素间距 ---->             |
|                                         |
|      [ 登录按钮 ] [ 切换模式按钮 ]      |
|                                         |
|      <---- 20像素间距 ---->             |
|                                         |
|      [       消息提示标签       ]       |
|                                         |
|           (空白, 被弹簧撑开)            |
+-----------------------------------------+
```

**总结：** 这种“化整为零，再合零为整”的布局方式是 Qt GUI 编程的核心思想。通过将界面划分为逻辑上独立的区域，为每个区域选择最合适的布局（水平、垂直或表单），最后再用一个主布局将它们组合起来，可以构建出任何复杂的界面。