# 问_1  
备用信号栈（alternate signal stack）是什么？  

# 答_1  
备用信号栈（alternate signal stack）是 POSIX 系统中用于信号处理的一个独立栈空间，用于执行信号处理函数（signal handler），而不是使用当前线程的默认栈。

### 主要特点和目的：
- **防止栈溢出**：信号可能在任何时刻中断程序执行，如果处理函数在当前栈上运行并消耗大量空间，可能导致栈溢出（stack overflow）。备用栈提供一个隔离的空间，避免这个问题。
- **隔离性**：备用栈与主栈分离，确保信号处理不会干扰或破坏主程序的栈状态。
- **大小可控**：备用栈的大小由程序员指定，通常较小（例如几 KB），专用于信号处理。

### 使用方式：
- 使用 `sigaltstack()` 函数设置备用栈（分配内存并指定栈指针和大小）。
- 在 `sigaction()` 中设置 `SA_ONSTACK` 标志，使信号处理函数在备用栈上执行。
- 示例：如果备用栈未设置，`SA_ONSTACK` 无效，处理函数仍使用默认栈。

这在多线程或复杂程序中特别有用，以提高信号处理的可靠性。  

# 问_2  
这个栈的地址空间在进程用户地址空间中吗？还是在内核地址空间中？  

# 答_2  
备用信号栈位于进程的用户地址空间中，而不是内核地址空间。

### 解释：
- **用户地址空间**：备用栈由用户程序通过 `malloc` 或类似函数分配的内存块组成，栈指针和大小由用户指定。内核不直接管理这个栈的内容，只是在信号发生时切换到它执行处理函数。
- **内核角色**：内核负责信号传递、栈切换和恢复，但栈数据本身存储在用户空间。内核地址空间是受保护的，不允许用户直接访问或修改。
- **安全性**：这确保了信号处理的安全性，避免内核空间被污染，同时允许用户控制栈大小以防止溢出。

在 Linux 等系统中，备用栈是用户空间的虚拟内存区域。